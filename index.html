<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Weather • Tomorrow.io</title><style>:root{--bg:#0b0f14;--card:#121821;--text:#e6eef8;--muted:#8ea2b6;--accent:#4da3ff}*{box-sizing:border-box}body{margin:0;background:linear-gradient(180deg,#0b0f14 0%,#0d131b 60%,#0f1620 100%);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text)}.wrap{max-width:980px;margin:40px auto;padding:0 16px}header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}h1{font-size:22px;margin:0;font-weight:600;letter-spacing:.2px}.cfg{display:flex;gap:8px;align-items:center;flex-wrap:wrap}input,select,button{background:var(--card);border:1px solid #1e2936;color:var(--text);padding:10px 12px;border-radius:10px;outline:none}input::placeholder{color:#68819a}button{cursor:pointer;border-color:#2a3a4d}button.primary{background:linear-gradient(180deg,#1e6bd8,#1455ad);border:none}.grid{display:grid;gap:16px;grid-template-columns:1.2fr 1fr}@media (max-width:900px){.grid{grid-template-columns:1fr}}.card{background:var(--card);border:1px solid #1b2431;border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}.row{display:flex;gap:14px;align-items:center}.big{font-size:56px;line-height:1;font-weight:700}.muted{color:var(--muted);font-size:14px}.pill{font-size:12px;color:#cfe4ff;background:#173153;padding:6px 10px;border-radius:999px;border:1px solid #284e7d;display:inline-block;margin-top:4px}.list{display:flex;gap:10px;overflow:auto;padding-bottom:4px}.hour{min-width:120px;background:#0f1520;border:1px solid #1c2737;border-radius:12px;padding:10px}.hour .t{font-size:18px;font-weight:600}.kvs{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:8px}.kv{background:#0f1520;border:1px solid #1c2737;border-radius:12px;padding:10px;font-size:14px;color:#d9e7ff}footer{margin-top:20px;text-align:center;color:#7fa6d6;font-size:12px}.err{color:#ff8a8a;white-space:pre-wrap}.note{color:#9fb3c9;font-size:12px}</style></head><body><div class="wrap"><header><h1>Weather • Tomorrow.io</h1><div class="cfg"><input id="lat" type="text" value="28.6139" title="Latitude" style="width:110px"/><input id="lon" type="text" value="77.2090" title="Longitude" style="width:110px"/><select id="hours"><option value="6">Next 6h</option><option value="12">Next 12h</option><option value="24" selected>Next 24h</option></select><button class="primary" id="go">Refresh</button></div></header><div class="grid"><div class="card" id="nowCard"><div class="row"><div class="big" id="tempNow">--°</div><div><div class="muted" id="locName">Lat 28.6139, Lon 77.2090</div><div class="pill" id="codeNow">—</div><div class="muted" id="timeNow">—</div></div></div><div class="kvs"><div class="kv">Humidity: <b id="humNow">—</b>%</div><div class="kv">Wind: <b id="windNow">—</b> m/s</div><div class="kv">Precip: <b id="precNow">—</b> mm/h</div><div class="kv">Feels like: <b id="feelsNow">—</b>°C</div></div></div><div class="card"><div class="muted" style="margin-bottom:8px">Hourly forecast</div><div class="list" id="hoursList"></div></div></div><div class="card" style="margin-top:16px"><div class="muted">Logs</div><pre id="log" style="white-space:pre-wrap; font-size:12px; color:#9fb3c9; margin-top:8px; max-height:180px; overflow:auto;"></pre><div class="err" id="err"></div><div class="note">Your API key is protected server‑side via Netlify Function. No key is exposed to the browser.</div></div><footer>Built for Brave.</footer></div><script>const $=e=>document.querySelector(e),log=e=>{const t=$("#log");t.textContent+=e+"\n",t.scrollTop=t.scrollHeight};const WEATHER_CODES={0:"Unknown",1000:"Clear",1100:"Mostly Clear",1101:"Partly Cloudy",1102:"Mostly Cloudy",1001:"Cloudy",2000:"Fog",2100:"Light Fog",3000:"Light Wind",3001:"Wind",3002:"Strong Wind",4000:"Drizzle",4001:"Rain",4200:"Light Rain",4201:"Heavy Rain",5000:"Snow",5001:"Flurries",5100:"Light Snow",5101:"Heavy Snow",6000:"Freezing Drizzle",6001:"Freezing Rain",6200:"Light Freezing Rain",6201:"Heavy Freezing Rain",7000:"Ice Pellets",7101:"Heavy Ice Pellets",7102:"Light Ice Pellets",8000:"Thunderstorm"};function fmtTime(e){const t=new Date(e);return t.toLocaleString([],{hour:"2-digit",minute:"2-digit",weekday:"short"})}async function fetchWeather(){$("#err").textContent="";const e=$("#lat").value.trim(),t=$("#lon").value.trim(),o=parseInt($("#hours").value,10),a="now",n=6===o?"nowPlus6h":12===o?"nowPlus12h":"nowPlus24h",s={location:`${e},${t}`,fields:["temperature","temperatureApparent","humidity","windSpeed","precipitationIntensity","weatherCode"],timesteps:["1h"],units:"metric",startTime:a,endTime:n};log("Calling server…");const i=await fetch("/.netlify/functions/timelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const e=await i.text();return $("#err").textContent=`HTTP ${i.status}: ${e}`,void log(`Error: HTTP ${i.status}`)}const l=await i.json();log("OK"),render(l,e,t)}function render(e,t,o){try{const a=e?.data?.timelines?.[0],n=a?.intervals||[];if(0===n.length)return void($("#err").textContent="No data.");const s=n[0];$("#tempNow").textContent=Math.round(s.values.temperature)+"°C",$("#humNow").textContent=Math.round(s.values.humidity),$("#windNow").textContent=(s.values.windSpeed??0).toFixed(1),$("#precNow").textContent=(s.values.precipitationIntensity??0).toFixed(2),$("#feelsNow").textContent=Math.round(s.values.temperatureApparent??s.values.temperature),$("#codeNow").textContent=WEATHER_CODES[s.values.weatherCode]||"—",$("#timeNow").textContent=fmtTime(s.startTime),$("#locName").textContent=`Lat ${t}, Lon ${o}`;const i=$("#hoursList");i.innerHTML="";for(const e of n){const t=document.createElement("div");t.className="hour",t.innerHTML=`<div class="t">${Math.round(e.values.temperature)}°C</div><div class="muted">${fmtTime(e.startTime)}</div><div class="kvs"><div>Hum: <b>${Math.round(e.values.humidity)}</b>%</div><div>Wind: <b>${(e.values.windSpeed??0).toFixed(1)}</b> m/s</div><div>Precip: <b>${(e.values.precipitationIntensity??0).toFixed(2)}</b> mm/h</div><div>${WEATHER_CODES[e.values.weatherCode]||""}</div></div>`,i.appendChild(t)}}catch(e){$("#err").textContent="Render error: "+(e?.message||e)}}window.addEventListener("DOMContentLoaded",()=>{$("#go").addEventListener("click",fetchWeather),fetchWeather()});</script></body></html>